---
import Main from '../layouts/main.astro';
import Card from '../components/Card.jsx';
import FocusCard from '../components/FocusCard.jsx';
import {VoteButton} from '../components/VoteButton.jsx';

const cards = import.meta.glob('../content/*.md', { eager: true });
const cardList = Object.values(cards);

const focusCards = import.meta.glob('../content/focus/*.md', { eager: true });
const focusList = Object.values(focusCards);
---

<Main>

  <div class="grid place-items-center h-screen content-center">
	  <h2 class="text-center text-2xl font-bold mb-8">Welcome to Case Study Design</h2>

  <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-5 gap-8">
    {cardList.map(({ frontmatter, Content }, i) => (
      <section key={i} class="space-y-4">
        <Card
          title={frontmatter.title}
          caption={frontmatter.caption}
          image={frontmatter.image}
          votes={frontmatter.votes}
          community={frontmatter.community}
          markdownContent={Content}
        />
        <div class="grid gap-4">
          <a href={frontmatter.readUrl} target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-center">
            Read
          </a>
          <VoteButton client:load voteLinks={frontmatter.voteLinks} />
        </div>
      </section>
    ))}
  </div>
  </div>
  {focusList.length > 0 && (
    <section class="mt-16">
      <FocusCard
        title={focusList[0].frontmatter.title}
        image={focusList[0].frontmatter.image}
        readUrl={focusList[0].frontmatter.readUrl}
        description={focusList[0].frontmatter.description}
      />
      <div class="prose prose-sm mt-4">
        <focusList[0].Content />
      </div>
      <VoteButton client:load voteLinks={focusList[0].frontmatter.voteLinks} />
    </section>
  )}
</Main>
